\documentclass{article}
\usepackage{lipsum}
\usepackage{boxedminipage}
\usepackage{fancyhdr}
\pagestyle{fancy}
\setlength{\headheight}{32pt}
\renewcommand{\sectionmark}[1]{\markboth{#1}{}}
\renewcommand{\subsectionmark}[1]{\markright{#1}}
\fancyhead[R]{\leftmark\\\rightmark}
\fancyhead[L]{\thepage}
\renewcommand{\headrule}{\vbox to 0pt
    {\hbox to\headwidth{\dotfill}\vss}}

\begin{document}

\tableofcontents

\section{Introduction}

\begin{boxedminipage}{\textwidth}
This is example 16 in the fancyhdr documentation.\\
We use a two-line header with section name on top of subsection name. Also the header rule is a dotted line. We must increase \verb|\headheight| to prevent Fancyhdr warnings.
\begin{verbatim}
\addtolength{\headheight}{\baselineskip}
\renewcommand{\sectionmark}[1]{\markboth{#1}{}}
\renewcommand{\subsectionmark}[1]{\markright{#1}}
\fancyhead[R]{\leftmark\\\rightmark}
\fancyhead[L]{\thepage}
\renewcommand{\headrule}{\vbox to 0pt
    {\hbox to\headwidth{\dotfill}\vss}}
\end{verbatim}
\end{boxedminipage}

\subsection{The Problem}
\label{sec:problem}

\lipsum[1]

\subsection{Evaluation}

\lipsum

Some more text.

Some more text.

Some more text.

Some more text.

This example shows that putting the \verb+\markright+ before the \verb+\subsection+ may cause it to be effected too early when the \verb+\subsection+ falls at the page break. The mark is in the header on this page, while the subsection starts at the next page.


\subsection{Another subsection}

\lipsum[3]

\end{document}
